using UnityEngine;
using UnityEngine.UI;

public class DialogueTrigger : MonoBehaviour
public class MeuScript : MonoBehaviour
{
    public Text dialogueText; // Referência ao componente de texto do diálogo
    public string dialogueContent; // Conteúdo completo do diálogo
    public KeyCode triggerKey = KeyCode.Z; // Tecla que irá acionar o diálogo (padrão: tecla de espaço)
    public float interactionDistance = 2f; // Distância máxima para interagir com o objeto

    private bool isTyping = false; // Flag para verificar se o texto está sendo digitado
    private int currentIndex = 0; // Índice do caractere atual

    void Start()
    {
        // Inicializa o diálogo com texto vazio
        dialogueText.text = "";
    }

    void Update()
    {
        // Verifica se o jogador está próximo e pressionou a tecla desejada
        if (Input.GetKeyDown(triggerKey) && !isTyping && IsPlayerNearby())
        {
            // Ativa o diálogo
            StartCoroutine(TypeDialogue());
        }
    }

    bool IsPlayerNearby()
    {
        // Verifica a distância entre o objeto e o jogador
        float distance = Vector3.Distance(transform.position, PlayerController.instance.transform.position);
        return distance <= interactionDistance;
    

    }
    public IEnumerator TypeDialogue(string dialogue, Text dialogueText)
    {
        isTyping = true;
        currentIndex = 0;
        dialogueText.text = "";

        // Digita o diálogo caractere por caractere
        while (currentIndex < dialogueContent.Length)
        {
            dialogueText.text += dialogueContent[currentIndex];
            currentIndex++;
            yield return new WaitForSeconds(0.05f); // Tempo de espera entre cada letra
        }

        isTyping = false;
    }
}
